<html>
	<head>
		<script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
		<script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
		<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.js"></script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/react-router-dom/5.0.1/react-router-dom.js'></script>
	</head>
	
	<style>
		body {
			font-family: Verdana;
		}

		nav {
			display: flex;
			justify-content: space-around;
		}

		.active{
			background-color: tomato;
			color: white;
			padding: 0.5rem;
		}

  	li {
    list-style-type: none;
		margin: 2rem;
  	}
	</style>
	
	<body>
		<div id="root"></div>
		<script type='text/babel'>
			const { render } = ReactDOM
			const { Component } = React
			const { HashRouter, Route, NavLink, Switch, Redirect } = ReactRouterDOM
			const API = "https://acme-users-api-rev.herokuapp.com/api"
			const n = 5

			const priceLessThanN = (products) => {
				return (products.filter(product => product.suggestedPrice < n))
			}

			const priceMoreThanN = (products) => {
				return (products.filter(product => product.suggestedPrice >= n))
			}

			const Nav = ({ products }) => {
				return (
					<nav>
						<NavLink to="/under">Under ${n} ({ priceLessThanN(products).length })</NavLink>
						<NavLink to="/over">{n} and Over ({ priceMoreThanN(products).length })</NavLink>
					</nav>
				)
			}

			const Lower = ({ props, products }) => {
				console.log(props)
				return (
					<div>
						<ul>
							{priceLessThanN(products).map((product, idx) => {
								return (
									<li key={product.id}>
										<div>{product.name}</div>
										<div>{product.suggestedPrice}</div>
									</li>
								)
							})}
						</ul>
					</div>
				)
			}

			const Higher = ({ products }) => {
				return (
					<div>
						<ul>
							{priceMoreThanN(products).map((product, idx) => {
								return (
									<li key={product.id}>
										<div>{product.name}</div>
										<div>{product.suggestedPrice}</div>
									</li>
								)
							})}
						</ul>
					</div>
				)
			}

			class App extends Component {
				constructor() {
					super()
					this.state = {
						products : [],
						companies : [],
						offerings : []
					}
				}

				async componentDidMount() {
					const products = (await axios.get(`${API}/products`)).data
					const companies = (await axios.get(`${API}/companies`)).data
					const offerings = (await axios.get(`${API}/offerings`)).data
					this.setState({ products, companies, offerings })
				}

				render() {
					const { products } = this.state
					return (
						<HashRouter>
							<h1>Acme 5 - Over / Under</h1>
							<Route render={ () => <Nav products = {products} /> } />
							<Switch>
								<Route path="/under" render={ (props) => <Lower props={props} products={products} />} />
								<Route path="/over" render={ () => <Higher products={products} />} />
							</Switch>
						</HashRouter>
					)
				}
			}
			const root = document.querySelector('#root')
			render(<App />, root)

		</script>	
	</body>
</html>